<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vincent Liu">
<meta name="dcterms.date" content="2022-10-29">

<title>In the Dark Aisles of Our Capital (Part I)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/clipboard/clipboard.min.js"></script>
<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/quarto.js"></script>
<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/popper.min.js"></script>
<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/anchor.min.js"></script>
<link href="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="UCR 2021 DC Arrest Data Analysis I_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="UCR 2021 DC Arrest Data Analysis I_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="UCR 2021 DC Arrest Data Analysis I_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#what-is-ucr-and-why-ucr-crime-data" id="toc-what-is-ucr-and-why-ucr-crime-data" class="nav-link active" data-scroll-target="#what-is-ucr-and-why-ucr-crime-data">What is UCR and Why UCR Crime Data?</a></li>
  <li><a href="#getting-the-data-and-setting-up-warming-up" id="toc-getting-the-data-and-setting-up-warming-up" class="nav-link" data-scroll-target="#getting-the-data-and-setting-up-warming-up">Getting the Data and Setting up: Warming Up</a></li>
  <li><a href="#cleaning-and-wrangling-the-data-making-hands-dirty" id="toc-cleaning-and-wrangling-the-data-making-hands-dirty" class="nav-link" data-scroll-target="#cleaning-and-wrangling-the-data-making-hands-dirty">Cleaning and Wrangling the Data: Making Hands Dirty</a>
  <ul class="collapse">
  <li><a href="#selecting-variables-of-interests" id="toc-selecting-variables-of-interests" class="nav-link" data-scroll-target="#selecting-variables-of-interests">Selecting Variables of Interests</a></li>
  <li><a href="#variable-manipulation" id="toc-variable-manipulation" class="nav-link" data-scroll-target="#variable-manipulation">Variable Manipulation</a></li>
  <li><a href="#final-check-does-any-missing-data-arise-after-manipulations" id="toc-final-check-does-any-missing-data-arise-after-manipulations" class="nav-link" data-scroll-target="#final-check-does-any-missing-data-arise-after-manipulations">Final Check: Does any missing data arise after manipulations?</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">In the Dark Aisles of Our Capital (Part I)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">A Data-driven Analysis of the UCR 2021 DC Arrest Data</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vincent Liu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 29, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="NIPRS.JPG" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Source: FBI UCR Program NIBRS Page</figcaption><p></p>
</figure>
</div>
<p>This series is published by Towards AI On Medium. <a href="https://medium.com/towards-artificial-intelligence/fostering-criminal-justice-with-data-science-part-i-be4cabdeb0a1">Link:</a>.</p>
<p>As a crime researcher, I am always intrigued by the questions of how many crimes were committed in a year and out of these crimes, how many arrests were made by officers. I explicitly mentioned arrests here because these two concepts are distinct in the sense that not all crimes resulted in an arrest. Most cases simply do not amount to the level of seriousness needed to validate an arrest for which should our attention is on behavioral biases of law enforcement agents (racial discrimination in policing), arrest usually is often a better metric.</p>
<p>In this post, I will be using data from the Uniform Crime Reporting (UCR) system to tell a story about who was arrested in DC - the nation’s capital and political center - in 2021, the passing year. I especially care about these three questions:</p>
<ul>
<li>Which racial, sex, or age group were arrested the heaviest by Metropolitan Police Department officers?</li>
<li>How were those arrests broken down by offense type and weapon use?</li>
<li>Was a certain racial or socioeconomic group more likely to be arrested for some types of offenses?</li>
</ul>
<p>While answering these questions, I will also show what I have been advocating for: using data science as a tool to understand the domain knowledge. I come from a social science background, and my interest in social science precedes my interest in data science. Accordingly, I believe that the importance of data science is that it provides tools for research scientists, policymakers, and companies. A lot of people in the data science field care more about the data algorithm than the data itself. I think they are of equal significance.</p>
<section id="what-is-ucr-and-why-ucr-crime-data" class="level2">
<h2 class="anchored" data-anchor-id="what-is-ucr-and-why-ucr-crime-data">What is UCR and Why UCR Crime Data?</h2>
<p>I chose UCR as my source of data for a reason. When I was undergraduate sociology of law, criminology, and deviance student at the University of Minnesota Twin Cities, Uniform Crime Report (UCR) data was the common “guest” in many of my major courses that a lot of us called it “the bible of crime research”. This is not to say UCR is the best source but that it is the most authoritative one. Its authoritativeness reflects on two points: it comes from a highly credible source (collected by the FBI) and it is very comprehensive (contains a myriad of information about crimes). No matter whether the researcher cares about the specific crime or arrest numbers in their living state or crime trends over the past decade, UCR is their go-to dataset.</p>
<p>UCR does not refer to a single data but a data reporting system used by the FBI and is comprised of over five distinct databases. Some of the more well-known ones include the National Incident-Based Reporting System (NIBRS), the Hate Crime Statistics, the Law Enforcement Officers Killed and Assaulted data, and the most recent National Use-of-Force Data Collection. Data in the UCR system comes from over 18,000+ academic institutions and law enforcement agencies of different levels who reported crime information voluntarily.</p>
<p>Now, let’s take a look at our data.</p>
</section>
<section id="getting-the-data-and-setting-up-warming-up" class="level2">
<h2 class="anchored" data-anchor-id="getting-the-data-and-setting-up-warming-up">Getting the Data and Setting up: Warming Up</h2>
<p>The 2021 DC arrest data is grasped from the National Incident-Based Reporting System (NIBRS) database, which can be accessed on the FBI’s <a href="https://crime-data-explorer.app.cloud.gov/pages/downloads">Crime Data Explorer portal</a>. To download the data, go to the “Crime Incident-Based Data by State” section, select “DC” and “2021” in dropdowns, and press “download”. This will give you a set of related datasets and their codebooks in a compressed form, and the arrest data is among them!</p>
<p>Before moving to real data science tasks, it’s always a good habit to load libraries first.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for easy data cleaning and wrangling</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats) <span class="co"># dealing with factor variables</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># string manipulations</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># data visualizations</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co"># an extension of the ggplot2 library</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># dealing with dates and times</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># reading data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># beautiful formatting of tables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center" style="float:right;">
<figure class="figure">
<p><img src="joins_diagram.JPG" class="img-fluid figure-img" alt="Relationships between different joining algorithms" width="401"></p>
<p></p><figcaption class="figure-caption">Source: Medium</figcaption><p></p>
</figure>
</div>
<p>We will need two datasets: the arrest data and the arrest_by_weapon data. The former records the time and natures of arrests, while the latter complements the former by adding information about the use of weapons by the offenders. To connect them, we do a left join. A left join retains all rows in dataset x during joining. The relationship between different joins can be seen on the right-side image, which comes from this <a href="https://joaomarcuraa.medium.com/sql-joins-and-aliases-1965fd2423ca">Medium post</a>. I named the joined dataset <code>dc21_arrests_weapon</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dc21_arrests <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/DC2021_NIBRS_ARRESTEE.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dc21_weapon <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/DC2021_NIBRS_ARRESTEE_WEAPON.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>dc21_arrests_weapon <span class="ot">&lt;-</span> dc21_arrests <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dc21_weapon, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"arrestee_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that some rows in <code>dc21_weapon</code> appear more than one-time for which doing a join, regardless of the join type, will always include the repetitive rows in the result dataset. This can be easily tested with the method below (no warning message means the test passed, i.e.&nbsp;both conditions rendered the same output).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(dc21_arrests <span class="sc">%&gt;%</span> <span class="fu">count</span>(arrestee_id) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>(),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                       dc21_weapon <span class="sc">%&gt;%</span> <span class="fu">count</span>(arrestee_id) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s look at what’s in the data. We do so by inspecting the first five rows and glimpsing variable types.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dc21_arrests_weapon <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format=</span><span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"hover"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> data_year.x </th>
   <th style="text-align:right;"> arrestee_id </th>
   <th style="text-align:right;"> incident_id </th>
   <th style="text-align:right;"> arrestee_seq_num </th>
   <th style="text-align:left;"> arrest_date </th>
   <th style="text-align:right;"> arrest_type_id </th>
   <th style="text-align:left;"> multiple_indicator </th>
   <th style="text-align:left;"> offense_code </th>
   <th style="text-align:right;"> age_id </th>
   <th style="text-align:left;"> age_num </th>
   <th style="text-align:left;"> sex_code </th>
   <th style="text-align:right;"> race_id </th>
   <th style="text-align:right;"> ethnicity_id </th>
   <th style="text-align:left;"> resident_code </th>
   <th style="text-align:left;"> under_18_disposition_code </th>
   <th style="text-align:left;"> clearance_ind </th>
   <th style="text-align:right;"> age_range_low_num </th>
   <th style="text-align:left;"> age_range_high_num </th>
   <th style="text-align:right;"> data_year.y </th>
   <th style="text-align:left;"> nibrs_arrestee_weapon_id </th>
   <th style="text-align:right;"> weapon_id </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:right;"> 44647723 </td>
   <td style="text-align:right;"> 145432401 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 2021-11-10 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> N </td>
   <td style="text-align:left;"> 23H </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> 25 </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> U </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 51 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:right;"> 44988819 </td>
   <td style="text-align:right;"> 146701882 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 2021-08-01 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> N </td>
   <td style="text-align:left;"> 13B </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:left;"> 24 </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> U </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 9 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:right;"> 44988803 </td>
   <td style="text-align:right;"> 146701733 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 2021-08-01 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> N </td>
   <td style="text-align:left;"> 290 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> 25 </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 98 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:left;"> U </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 51 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:right;"> 44988815 </td>
   <td style="text-align:right;"> 146701843 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 2021-08-01 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> N </td>
   <td style="text-align:left;"> 13B </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:left;"> 23 </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:left;"> R </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 23 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 51 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:right;"> 44398472 </td>
   <td style="text-align:right;"> 144484722 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> 2021-09-29 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:left;"> N </td>
   <td style="text-align:left;"> 13B </td>
   <td style="text-align:right;"> 43 </td>
   <td style="text-align:left;"> 40 </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> U </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:right;"> 51 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>There are quite a few ways to check variable types. Many people love to use <code>glimpse()</code> since it’s well integrated with the <code>tidyverse</code> system. Here, I used base R’s <code>str()</code> method because I really like its layout. Both methods did very similar things, so there isn’t a trade-off here. Just use whichever you prefer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dc21_arrests_weapon %&gt;% glimpse()</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dc21_arrests_weapon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spec_tbl_df [4,508 × 21] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ data_year.x              : num [1:4508] 2021 2021 2021 2021 2021 ...
 $ arrestee_id              : num [1:4508] 44647723 44988819 44988803 44988815 44398472 ...
 $ incident_id              : num [1:4508] 1.45e+08 1.47e+08 1.47e+08 1.47e+08 1.44e+08 ...
 $ arrestee_seq_num         : num [1:4508] 1 1 1 1 1 1 1 1 1 1 ...
 $ arrest_date              : Date[1:4508], format: "2021-11-10" "2021-08-01" ...
 $ arrest_type_id           : num [1:4508] 3 1 3 3 3 1 3 1 3 1 ...
 $ multiple_indicator       : chr [1:4508] "N" "N" "N" "N" ...
 $ offense_code             : chr [1:4508] "23H" "13B" "290" "13B" ...
 $ age_id                   : num [1:4508] 28 27 28 26 43 38 38 52 46 26 ...
 $ age_num                  : chr [1:4508] "25" "24" "25" "23" ...
 $ sex_code                 : chr [1:4508] "M" "F" "F" "M" ...
 $ race_id                  : num [1:4508] 20 20 98 20 20 20 20 20 20 20 ...
 $ ethnicity_id             : num [1:4508] 20 20 10 20 40 40 20 40 20 20 ...
 $ resident_code            : chr [1:4508] "U" "U" "U" "R" ...
 $ under_18_disposition_code: chr [1:4508] NA NA NA NA ...
 $ clearance_ind            : logi [1:4508] NA NA NA NA NA NA ...
 $ age_range_low_num        : num [1:4508] 25 24 25 23 40 35 35 49 43 23 ...
 $ age_range_high_num       : chr [1:4508] NA NA NA NA ...
 $ data_year.y              : num [1:4508] 2021 2021 2021 2021 2021 ...
 $ nibrs_arrestee_weapon_id : logi [1:4508] NA NA NA NA NA NA ...
 $ weapon_id                : num [1:4508] 51 9 51 51 51 51 51 52 3 51 ...
 - attr(*, "spec")=
  .. cols(
  ..   data_year = col_double(),
  ..   arrestee_id = col_double(),
  ..   incident_id = col_double(),
  ..   arrestee_seq_num = col_double(),
  ..   arrest_date = col_date(format = ""),
  ..   arrest_type_id = col_double(),
  ..   multiple_indicator = col_character(),
  ..   offense_code = col_character(),
  ..   age_id = col_double(),
  ..   age_num = col_character(),
  ..   sex_code = col_character(),
  ..   race_id = col_double(),
  ..   ethnicity_id = col_double(),
  ..   resident_code = col_character(),
  ..   under_18_disposition_code = col_character(),
  ..   clearance_ind = col_logical(),
  ..   age_range_low_num = col_double(),
  ..   age_range_high_num = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>Here we see the data has 4,508 rows and 21 columns. The former suggests that in year 2021, there were <strong>a total of 4,508 arrests</strong> in DC, whereas, the latter tells us 21 variables are included in this data. Most of them are numeric, some are strings, and there are a few that are booleans (“logi”) and the date type. Examining variable types helps us understand our data better and makes our data cleaning easier.</p>
</section>
<section id="cleaning-and-wrangling-the-data-making-hands-dirty" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-and-wrangling-the-data-making-hands-dirty">Cleaning and Wrangling the Data: Making Hands Dirty</h2>
<p>Let’s move to the data cleaning stage. I think one reason why I really like data cleaning is that it is so logical. If there are unnecessary variables, drop them! If something is not right, manipulate them and manipulate them with as many steps as needed and as few step as possible! We clean data one-step at a time, and after a step, we look back to see if we did it right. In fact, we need to constantly look back and make changes on our previous codes to ensure we are on the right track. The mindset will also help us, (rising or experienced) data scientists, be more familiar with and develop a stronger understanding of our data.</p>
<p>For me, data cleaning actually made me get into the field of data science. When I learned R programming in my undergraduate as a statistics major (I pursued two majors), there was no class about <code>dplyr</code> or <code>ggplot2</code> and I learned how to clean data by myself in two weeks while working on a data science project. It wasn’t easy at the beginning because the <code>tidyverse</code> syntax is so different from base R, however, the more I used it, the more I found myself addicted to it. As I said I came from a research background, so the problem-driven mindset inside the tidyverse framework is so natural and intuitive to me, which made me love doing data cleaning almost instantly.</p>
<section id="selecting-variables-of-interests" class="level3">
<h3 class="anchored" data-anchor-id="selecting-variables-of-interests">Selecting Variables of Interests</h3>
<p>Going back to our data, we need to do a few things before the most exciting part - explorative data analysis. We need to remove unnecessary variables so that our data only captures the main points of our analysis. This is especially important if our data has a few hundred columns, which could be common in the public and nonprofit sectors. For this one, our data has 21 variables, which is a moderate number, so data selection is not necessary but it never hurts to do so. We have to be cautious, though, to ensure we don’t filter out variables that we actually need. To do that, it’s often necessary to look for a codebook or an online code documentation page to make sure we are not being subjective about our variable interpretations. A codebook of the NIBRS dataset can be found on the same page we download our data or accessed <a href="https://s3-us-gov-west-1.amazonaws.com/cg-d4b776d0-d898-4153-90c8-8336f86bdfec/NIBRS_DataDictionary.pdf">here</a>.</p>
<p>Out of these 21 variables, we found out <code>arrest_id</code>, <code>incident_id</code>, <code>arrestee_sql_num</code> are all used to identify arrests/arrestees, and variables <code>age_id</code>, <code>age_num</code>, <code>under_18_disposition_code</code>, <code>age_range_low_num</code>, <code>age_range_high_num</code> all represent arrestees’ age (we have the variable variation here because juveniles go through a different prosecution system and are often coded divergently from adults to protect their privacy). Moreover, there are a few variables that are out of the bond of our topic and thus, filtered out.</p>
<p>It turns out that we only kept 8 variables. I also renamed these variables so that their names are more reflective of what they represent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21_arrests_weapon <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(data_year.x, arrest_date, arrest_type_id, offense_code, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         age_id, sex_code, race_id, weapon_id) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">year =</span> data_year.x, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> arrest_date,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrest_type =</span> arrest_type_id,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">offense =</span> offense_code, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> age_id,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> sex_code,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">race =</span> race_id,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">weapon =</span> weapon_id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="variable-manipulation" class="level3">
<h3 class="anchored" data-anchor-id="variable-manipulation">Variable Manipulation</h3>
<p>Now, noticed that <code>race</code>, <code>arrest_type</code>, and <code>weapon</code> are labelled numerically, which is a common practice in data entry. However, it’s hard to know what each number means without referencing the codebook. Therefore, let’s do some recoding, starting from variable <code>race</code>.</p>
<p>Through some simple manipulations, we found race has 6 categories with categories 30, 40, 50 having under 20 arrest cases. Because their numbers are so small comparing to other racial groups, we can combine them together. Category 98 represents arrestees whose racial information is unknown, either because the officer forgot to write it down (it happens!) or for some other reasons. I dropped out this category.</p>
<p>I am using functions from the <strong>forcats</strong> package to simplify the task.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(race) <span class="co"># see what racial groups we have</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
   race     n
  &lt;dbl&gt; &lt;int&gt;
1    10   377
2    20  3978
3    30     1
4    40    16
5    50     8
6    98   128</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>race <span class="sc">==</span> <span class="st">"98"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">factor</span>(race)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">fct_collapse</span>(race,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">White =</span> <span class="st">"10"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Black or African American</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"20"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Asian</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"40"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">American Indian or Pacific Islander</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"30"</span>,<span class="st">"50"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">fct_relevel</span>(race,  <span class="co"># relevel</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Black or African American"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">after =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">fct_relevel</span>(race,  <span class="co"># relevel</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Asian"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">after =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeating the process to variables <code>weapon</code> and <code>sex</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(weapon) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   weapon     n
    &lt;dbl&gt; &lt;int&gt;
 1      1     3
 2      3   445
 3      4    17
 4      5     8
 5      6     1
 6      7     3
 7      9   254
 8     51  3415
 9     52   215
10     53    19</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weapon =</span> <span class="fu">factor</span>(weapon)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weapon =</span> <span class="fu">fct_collapse</span>(weapon,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unarmed =</span> <span class="st">"51"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Firearm-involved</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"9"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Weapon with a blade</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"52"</span>, <span class="st">"53"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weapon =</span> <span class="fu">fct_relevel</span>(weapon,  </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Firearm-involved"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">after =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For <code>sex</code>, all we need is renaming factors, which can be easily done with the <code>fct_recode</code>. Alternatively, you can use base R’s <code>recode</code> function to do the same.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dc21<span class="sc">$</span>sex <span class="ot">=</span> <span class="fu">fct_recode</span>(dc21<span class="sc">$</span>sex, <span class="at">Male =</span> <span class="st">"M"</span>, <span class="at">Female =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For <code>offense</code>, we need to have some extra considerations. Noticed that most offenses categories are made up of two components: a two-digit number and a letter. These two components respectively represent the first group and second group of offenses. For instance, 13 represents assaults, and the A, B, C that come after 13 specify the type and degree of assaults so that 13A represents aggravated assaults while 13B represents simple assaults. This classification approach has important legal and policy meanings. We can also utilize this classification approach to reduce our workloads.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(offense) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 2
   offense     n
   &lt;chr&gt;   &lt;int&gt;
 1 09A        36
 2 100        18
 3 11A        22
 4 11C         5
 5 11D        52
 6 120       275
 7 13A       347
 8 13B      1771
 9 13C       336
10 200         1
# … with 25 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense =</span> <span class="fu">factor</span>(offense)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense =</span> <span class="fu">fct_collapse</span>(offense,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Murder and Nonnegligent Manslaughter</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"09A"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Aggravated Assault</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"13A"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Assault or Intimidation</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"13B"</span>, <span class="st">"13C"</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sexual Assault or Rape</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"11A"</span>, <span class="st">"11C"</span>, <span class="st">"11D"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Robbery</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"120"</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Arson and Kidnapping/Abduction</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"100"</span>, <span class="st">"200"</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Burglary or Trespassing</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"220"</span>, <span class="st">"90J"</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Theft, Auto-theft, and Larceny</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"23A"</span>, <span class="st">"23B"</span>, <span class="st">"23C"</span>, <span class="st">"23D"</span>, <span class="st">"23F"</span>, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"23G"</span>,<span class="st">"23H"</span>, <span class="st">"240"</span>),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Fraud</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"26A"</span>, <span class="st">"26C"</span>, <span class="st">"26D"</span>, <span class="st">"26E"</span>, <span class="st">"26F"</span>, <span class="st">"26G"</span>),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Drug-related</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"35A"</span> , <span class="st">"35B"</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Property Destruction</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"250"</span>, <span class="st">"280"</span>, <span class="st">"290"</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Crime against sociey</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"370"</span>,<span class="st">"39A"</span>, <span class="st">"520"</span>, <span class="st">"90Z"</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The 12 offense types above can be broadly characterized into four groups: violent crimes (or crimes against person), property crimes (crimes against property), and others (drug crimes and crimes against society) according to the object of crimes. The classification method follows how crimes are defined in criminal law and are commonly used by law enforcement agencies. For releveling purposes, we made this new variable a factor.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Violent_crimes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Murder and Nonnegligent Manslaughter"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aggravated Assault"</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Assault or Intimidation"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sexual Assault or Rape"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Robbery"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Arson and Kidnapping/Abduction"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>Property_crimes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Burglary or Trespassing"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Theft, Auto-theft, and Larceny"</span>, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Fraud"</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Property Destruction"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>Drug_crimes <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Drug-related"</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>Crime_sociey <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Crime against sociey"</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Violent_crimes <span class="sc">~</span> <span class="st">"Violent Crimes"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Property_crimes <span class="sc">~</span> <span class="st">"Property Crimes"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Drug_crimes <span class="sc">~</span> <span class="st">"Drug Crimes"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Crime_sociey <span class="sc">~</span> <span class="st">"Crime Against Society"</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense_group =</span> <span class="fu">fct_relevel</span>(offense_group,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="st">"Violent Crimes"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Property Crimes"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Drug Crimes"</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Crime Against Society"</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                                     ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The remaining variables are a little bit tricky here. For <code>date</code>, it makes little sense to know on which date arrests occurred but instead, knowing the months could provide some insights. Since <code>date</code> is in its own type (by default, R makes all date/time-related variables in POSIXIt format), we use functions from the <code>lubridate</code> package to make the transformation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>), </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> date) <span class="co"># add label = T makes month a ordered factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For <code>arrest_type</code>, this variable represents which stage of arrest the arrestee is on. Some people were arrested, some were waiting for the summoning of the court, and some were detained (in technical terms, these are stages in the “criminal justice funnel”). Because it represents three stages, we need to make it a categorical variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrest_type =</span> <span class="fu">factor</span>(arrest_type)) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrest_type =</span> <span class="fu">fct_recode</span>(arrest_type, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">On View</span><span class="st">`</span>  <span class="ot">=</span> <span class="st">"1"</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">Summoned/Cited</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">Custodied</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"3"</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#On View: arresting based on observations in lieu of written probable cause</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, for <code>age</code>, we can either leave it be (good for histogram or area chart)or use it to make a new variable age_group (good for bar charts, line charts etc.), depending on the preference of the data scientist and/or the purpose of analysis. Here, I am adopting the latter approach.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Under 20"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&gt;=</span><span class="dv">20</span> <span class="sc">~</span> <span class="st">"20-29"</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span><span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span><span class="dv">40</span> <span class="sc">~</span> <span class="st">"30-39"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"40-49"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"50 or above"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"40-49"</span>, <span class="st">"50 or above"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(age_group, <span class="at">.after =</span> age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="final-check-does-any-missing-data-arise-after-manipulations" class="level3">
<h3 class="anchored" data-anchor-id="final-check-does-any-missing-data-arise-after-manipulations">Final Check: Does any missing data arise after manipulations?</h3>
<p>Now we are done with our data wrangling, but before we move to data exploration, let’s make sure we are not leaving out any values. We can do so by checking there is no missing data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(dc21)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         year          date         month   arrest_type       offense 
            0             0             0             0             0 
          age     age_group           sex          race        weapon 
            0             0             0             0             0 
offense_group 
            0 </code></pre>
</div>
</div>
<p>Looks like we made no mistakes in previous steps. Good job! Here is what our final data looks like. Sounds good to you?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format=</span><span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"hover"</span>, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> year </th>
   <th style="text-align:left;"> date </th>
   <th style="text-align:left;"> month </th>
   <th style="text-align:left;"> arrest_type </th>
   <th style="text-align:left;"> offense </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> age_group </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:left;"> race </th>
   <th style="text-align:left;"> weapon </th>
   <th style="text-align:left;"> offense_group </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> 2021-11-10 </td>
   <td style="text-align:left;"> Nov </td>
   <td style="text-align:left;"> Custodied </td>
   <td style="text-align:left;"> Theft, Auto-theft, and Larceny </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:left;"> 20-29 </td>
   <td style="text-align:left;"> Male </td>
   <td style="text-align:left;"> Black or African American </td>
   <td style="text-align:left;"> Unarmed </td>
   <td style="text-align:left;"> Property Crimes </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> 2021-08-01 </td>
   <td style="text-align:left;"> Aug </td>
   <td style="text-align:left;"> On View </td>
   <td style="text-align:left;"> Assault or Intimidation </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:left;"> 20-29 </td>
   <td style="text-align:left;"> Female </td>
   <td style="text-align:left;"> Black or African American </td>
   <td style="text-align:left;"> Firearm-involved </td>
   <td style="text-align:left;"> Violent Crimes </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> 2021-08-01 </td>
   <td style="text-align:left;"> Aug </td>
   <td style="text-align:left;"> Custodied </td>
   <td style="text-align:left;"> Assault or Intimidation </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:left;"> 20-29 </td>
   <td style="text-align:left;"> Male </td>
   <td style="text-align:left;"> Black or African American </td>
   <td style="text-align:left;"> Unarmed </td>
   <td style="text-align:left;"> Violent Crimes </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> 2021-09-29 </td>
   <td style="text-align:left;"> Sep </td>
   <td style="text-align:left;"> Custodied </td>
   <td style="text-align:left;"> Assault or Intimidation </td>
   <td style="text-align:right;"> 43 </td>
   <td style="text-align:left;"> 40-49 </td>
   <td style="text-align:left;"> Male </td>
   <td style="text-align:left;"> Black or African American </td>
   <td style="text-align:left;"> Unarmed </td>
   <td style="text-align:left;"> Violent Crimes </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2021 </td>
   <td style="text-align:left;"> 2021-08-01 </td>
   <td style="text-align:left;"> Aug </td>
   <td style="text-align:left;"> On View </td>
   <td style="text-align:left;"> Theft, Auto-theft, and Larceny </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:left;"> 30-39 </td>
   <td style="text-align:left;"> Male </td>
   <td style="text-align:left;"> Black or African American </td>
   <td style="text-align:left;"> Unarmed </td>
   <td style="text-align:left;"> Property Crimes </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Full code can be found on my <a href="https://github.com/jcvincentliu/data-blogging/blob/main/UCR%202021%20DC%20Arrest%20Data%20Analysis.qmd">Github repo</a>.</p>
<p>In the next section, we will focus on using the tool of explorative data analysis(EDA) to inspect our data and answer the questions I posed at the beginning of this post. We will also talk about data storytelling - the art of using data to narrate a story. Stay tuned!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(dc21, <span class="at">file =</span> <span class="st">"data/final_data.rda"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(dc21, <span class="at">file =</span> <span class="st">"data/final_data.csv"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"graph/arrest_line_chart.png"</span>, <span class="at">plot =</span> p1,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"graph/offense_bar_chart.png"</span>, <span class="at">plot =</span> p2,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.0 (2022-04-22 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22000)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] kableExtra_1.3.4 readr_2.1.2      lubridate_1.8.0  GGally_2.1.2    
[5] ggplot2_3.3.6    stringr_1.4.0    forcats_0.5.1    dplyr_1.0.9     

loaded via a namespace (and not attached):
 [1] tidyselect_1.1.2   xfun_0.31          purrr_0.3.4        testthat_3.1.4    
 [5] colorspace_2.0-3   vctrs_0.4.1        generics_0.1.2     htmltools_0.5.3   
 [9] viridisLite_0.4.0  yaml_2.3.5         utf8_1.2.2         rlang_1.0.2       
[13] pillar_1.8.1       glue_1.6.2         withr_2.5.0        DBI_1.1.2         
[17] bit64_4.0.5        RColorBrewer_1.1-3 lifecycle_1.0.1    plyr_1.8.7        
[21] munsell_0.5.0      gtable_0.3.0       rvest_1.0.2        htmlwidgets_1.5.4 
[25] evaluate_0.17      knitr_1.40         tzdb_0.3.0         fastmap_1.1.0     
[29] parallel_4.2.0     fansi_1.0.3        highr_0.9          Rcpp_1.0.9        
[33] scales_1.2.0       desc_1.4.2         pkgload_1.2.4      vroom_1.5.7       
[37] webshot_0.5.3      jsonlite_1.8.0     bit_4.0.4          systemfonts_1.0.4 
[41] brio_1.1.3         hms_1.1.1          digest_0.6.29      stringi_1.7.6     
[45] rprojroot_2.0.3    grid_4.2.0         cli_3.3.0          tools_4.2.0       
[49] magrittr_2.0.3     tibble_3.1.7       crayon_1.5.2       pkgconfig_2.0.3   
[53] ellipsis_0.3.2     xml2_1.3.3         assertthat_0.2.1   rmarkdown_2.14    
[57] reshape_0.8.9      svglite_2.1.0      httr_1.4.4         rstudioapi_0.14   
[61] R6_2.5.1           compiler_4.2.0    </code></pre>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb28" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "In the Dark Aisles of Our Capital (Part I)"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "A Data-driven Analysis of the UCR 2021 DC Arrest Data"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Vincent Liu"</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%d %B, %Y')`"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">    html:</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: true</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">      toc-title: "Table of Contents"</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">      code-fold: true</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">      code-tools: true</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">      smooth-scroll: true</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">      link-external-icon: true</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">      link-external-newwindow: true</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">    pdf:</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">      toc: false</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">      fig-cap-location: bottom</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">      prefer-html: true</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="al">![Source:  FBI UCR Program NIBRS Page](NIPRS.JPG)</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>This series is published by Towards AI On Medium. <span class="co">[</span><span class="ot">Link:</span><span class="co">](https://medium.com/towards-artificial-intelligence/fostering-criminal-justice-with-data-science-part-i-be4cabdeb0a1)</span>.</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>As a crime researcher, I am always intrigued by the questions of how many crimes were committed in a year and out of these crimes, how many arrests were made by officers. I explicitly mentioned arrests here because these two concepts are distinct in the sense that not all crimes resulted in an arrest. Most cases simply do not amount to the level of seriousness needed to validate an arrest for which should our attention is on behavioral biases of law enforcement agents (racial discrimination in policing), arrest usually is often a better metric.</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>In this post, I will be using data from the Uniform Crime Reporting (UCR) system to tell a story about who was arrested in DC - the nation's capital and political center - in 2021, the passing year. I especially care about these three questions:</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Which racial, sex, or age group were arrested the heaviest by Metropolitan Police Department officers? </span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How were those arrests broken down by offense type and weapon use?</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Was a certain racial or socioeconomic group more likely to be arrested for some types of offenses?</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>While answering these questions, I will also show what I have been advocating for: using data science as a tool to understand the domain knowledge. I come from a social science background, and my interest in social science precedes my interest in data science. Accordingly, I believe that the importance of data science is that it provides tools for research scientists, policymakers, and companies. A lot of people in the data science field care more about the data algorithm than the data itself. I think they are of equal significance.</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is UCR and Why UCR Crime Data?</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>I chose UCR as my source of data for a reason. When I was undergraduate sociology of law, criminology, and deviance student at the University of Minnesota Twin Cities, Uniform Crime Report (UCR) data was the common "guest" in many of my major courses that a lot of us called it "the bible of crime research". This is not to say UCR is the best source but that it is the most authoritative one. Its authoritativeness reflects on two points: it comes from a highly credible source (collected by the FBI) and it is very comprehensive (contains a myriad of information about crimes). No matter whether the researcher cares about the specific crime or arrest numbers in their living state or crime trends over the past decade, UCR is their go-to dataset. </span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>UCR does not refer to a single data but a data reporting system used by the FBI and is comprised of over five distinct databases. Some of the more well-known ones include the National Incident-Based Reporting System (NIBRS), the Hate Crime Statistics, the Law Enforcement Officers Killed and Assaulted data, and the most recent National Use-of-Force Data Collection. Data in the UCR system comes from over 18,000+ academic institutions and law enforcement agencies of different levels who reported crime information voluntarily. </span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>Now, let's take a look at our data.</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getting the Data and Setting up: Warming Up </span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>The 2021 DC arrest data is grasped from the National Incident-Based Reporting System (NIBRS) database, which can be accessed on the FBI's <span class="co">[</span><span class="ot">Crime Data Explorer portal</span><span class="co">](https://crime-data-explorer.app.cloud.gov/pages/downloads)</span>. To download the data, go to the "Crime Incident-Based Data by State" section, select "DC" and "2021" in dropdowns, and press "download". This will give you a set of related datasets and their codebooks in a compressed form, and the arrest data is among them! </span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>Before moving to real data science tasks, it's always a good habit to load libraries first. </span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r set-up}</span></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for easy data cleaning and wrangling</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats) <span class="co"># dealing with factor variables</span></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># string manipulations</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># data visualizations</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co"># an extension of the ggplot2 library</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># dealing with dates and times</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># reading data</span></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># beautiful formatting of tables</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a><span class="al">![Source: Medium](joins_diagram.JPG)</span>{style="float:right;" fig-alt="Relationships between different joining algorithms" width="401"}</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>We will need two datasets: the arrest data and the arrest_by_weapon data. The former records the time and natures of arrests, while the latter complements the former by adding information about the use of weapons by the offenders. To connect them, we do a left join. A left join retains all rows in dataset x during joining. The relationship between different joins can be seen on the right-side image, which comes from this <span class="co">[</span><span class="ot">Medium post</span><span class="co">](https://joaomarcuraa.medium.com/sql-joins-and-aliases-1965fd2423ca)</span>. I named the joined dataset <span class="in">`dc21_arrests_weapon`</span>.</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>dc21_arrests <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/DC2021_NIBRS_ARRESTEE.csv"</span>)</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>dc21_weapon <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/DC2021_NIBRS_ARRESTEE_WEAPON.csv"</span>)</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>dc21_arrests_weapon <span class="ot">&lt;-</span> dc21_arrests <span class="sc">%&gt;%</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>  dc21_weapon, </span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"arrestee_id"</span>)</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>Note that some rows in <span class="in">`dc21_weapon`</span> appear more than one-time for which doing a join, regardless of the join type, will always include the repetitive rows in the result dataset. This can be easily tested with the method below (no warning message means the test passed, i.e. both conditions rendered the same output).   </span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(dc21_arrests <span class="sc">%&gt;%</span> <span class="fu">count</span>(arrestee_id) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>(),</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>                       dc21_weapon <span class="sc">%&gt;%</span> <span class="fu">count</span>(arrestee_id) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>())</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>Let's look at what's in the data. We do so by inspecting the first five rows and glimpsing variable types. </span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>dc21_arrests_weapon <span class="sc">%&gt;%</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format=</span><span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, </span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"hover"</span>, </span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"condensed"</span>))</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>There are quite a few ways to check variable types. Many people love to use <span class="in">`glimpse()`</span> since it's well integrated with the <span class="in">`tidyverse`</span> system. Here, I used base R's <span class="in">`str()`</span> method because I really like its layout. Both methods did very similar things, so there isn't a trade-off here. Just use whichever you prefer.</span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a><span class="co">#dc21_arrests_weapon %&gt;% glimpse()</span></span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dc21_arrests_weapon)</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>Here we see the data has 4,508 rows and 21 columns. The former suggests that in year 2021, there were **a total of 4,508 arrests** in DC, whereas, the latter tells us 21 variables are included in this data. Most of them are numeric, some are strings, and there are a few that are booleans ("logi") and the date type. Examining variable types helps us understand our data better and makes our data cleaning easier.</span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaning and Wrangling the Data: Making Hands Dirty</span></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>Let's move to the data cleaning stage. I think one reason why I really like data cleaning is that it is so logical. If there are unnecessary variables, drop them! If something is not right, manipulate them and manipulate them with as many steps as needed and as few step as possible! We clean data one-step at a time, and after a step, we look back to see if we did it right. In fact, we need to constantly look back and make changes on our previous codes to ensure we are on the right track. The mindset will also help us, (rising or experienced) data scientists, be more familiar with and develop a stronger understanding of our data.</span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>For me, data cleaning actually made me get into the field of data science. When I learned R programming in my undergraduate as a statistics major (I pursued two majors), there was no class about <span class="in">`dplyr`</span> or <span class="in">`ggplot2`</span> and I learned how to clean data by myself in two weeks while working on a data science project. It wasn't easy at the beginning because the <span class="in">`tidyverse`</span> syntax is so different from base R, however, the more I used it, the more I found myself addicted to it. As I said I came from a research background, so the problem-driven mindset inside the tidyverse framework is so natural and intuitive to me, which made me love doing data cleaning almost instantly.  </span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selecting Variables of Interests </span></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>Going back to our data, we need to do a few things before the most exciting part - explorative data analysis. We need to remove unnecessary variables so that our data only captures the main points of our analysis. This is especially important if our data has a few hundred columns, which could be common in the public and nonprofit sectors. For this one, our data has 21 variables, which is a moderate number, so data selection is not necessary but it never hurts to do so. We have to be cautious, though, to ensure we don't filter out variables that we actually need. To do that, it's often necessary to look for a codebook or an online code documentation page to make sure we are not being subjective about our variable interpretations. A codebook of the NIBRS dataset can be found on the same page we download our data or accessed <span class="co">[</span><span class="ot">here</span><span class="co">](https://s3-us-gov-west-1.amazonaws.com/cg-d4b776d0-d898-4153-90c8-8336f86bdfec/NIBRS_DataDictionary.pdf)</span>. </span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>Out of these 21 variables, we found out <span class="in">`arrest_id`</span>, <span class="in">`incident_id`</span>, <span class="in">`arrestee_sql_num`</span> are all used to identify arrests/arrestees, and variables <span class="in">`age_id`</span>, <span class="in">`age_num`</span>, <span class="in">`under_18_disposition_code`</span>, <span class="in">`age_range_low_num`</span>, <span class="in">`age_range_high_num`</span> all represent arrestees' age (we have the variable variation here because juveniles go through a different prosecution system and are often coded divergently from adults to protect their privacy). Moreover, there are a few variables that are out of the bond of our topic and thus, filtered out. </span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>It turns out that we only kept 8 variables. I also renamed these variables so that their names are more reflective of what they represent.   </span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21_arrests_weapon <span class="sc">%&gt;%</span></span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(data_year.x, arrest_date, arrest_type_id, offense_code, </span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a>         age_id, sex_code, race_id, weapon_id) <span class="sc">%&gt;%</span></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">year =</span> data_year.x, </span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> arrest_date,</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>         <span class="at">arrest_type =</span> arrest_type_id,</span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>         <span class="at">offense =</span> offense_code, </span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> age_id,</span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> sex_code,</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>         <span class="at">race =</span> race_id,</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>         <span class="at">weapon =</span> weapon_id) </span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variable Manipulation</span></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a>Now, noticed that <span class="in">`race`</span>, <span class="in">`arrest_type`</span>, and <span class="in">`weapon`</span> are labelled numerically, which is a common practice in data entry. However, it's hard to know what each number means without referencing the codebook. Therefore, let's do some recoding, starting from variable <span class="in">`race`</span>.</span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>Through some simple manipulations, we found race has 6 categories with categories 30, 40, 50 having under 20 arrest cases. Because their numbers are so small comparing to other racial groups, we can combine them together. Category 98 represents arrestees whose racial information is unknown, either because the officer forgot to write it down (it happens!) or for some other reasons. I dropped out this category.  </span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>I am using functions from the **forcats** package to simplify the task.</span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(race) <span class="co"># see what racial groups we have</span></span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>race <span class="sc">==</span> <span class="st">"98"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">factor</span>(race)) <span class="sc">%&gt;%</span></span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">fct_collapse</span>(race,</span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">White =</span> <span class="st">"10"</span>,</span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Black or African American</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"20"</span>,</span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Asian</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"40"</span>,</span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">American Indian or Pacific Islander</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"30"</span>,<span class="st">"50"</span>)</span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">fct_relevel</span>(race,  <span class="co"># relevel</span></span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Black or African American"</span>,</span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a>                            <span class="at">after =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">fct_relevel</span>(race,  <span class="co"># relevel</span></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Asian"</span>,</span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a>                            <span class="at">after =</span> <span class="dv">2</span>))</span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a>Repeating the process to variables <span class="in">`weapon`</span> and <span class="in">`sex`</span>.</span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(weapon) </span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weapon =</span> <span class="fu">factor</span>(weapon)) <span class="sc">%&gt;%</span></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weapon =</span> <span class="fu">fct_collapse</span>(weapon,</span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unarmed =</span> <span class="st">"51"</span>,</span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Firearm-involved</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"9"</span>),</span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Weapon with a blade</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"52"</span>, <span class="st">"53"</span>)</span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weapon =</span> <span class="fu">fct_relevel</span>(weapon,  </span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Firearm-involved"</span>,</span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a>                            <span class="at">after =</span> <span class="dv">1</span>)) </span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a>For <span class="in">`sex`</span>, all we need is renaming factors, which can be easily done with the <span class="in">`fct_recode`</span>. Alternatively, you can use base R's <span class="in">`recode`</span> function to do the same.</span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a>dc21<span class="sc">$</span>sex <span class="ot">=</span> <span class="fu">fct_recode</span>(dc21<span class="sc">$</span>sex, <span class="at">Male =</span> <span class="st">"M"</span>, <span class="at">Female =</span> <span class="st">"F"</span>)</span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a>For <span class="in">`offense`</span>, we need to have some extra considerations. Noticed that most offenses categories are made up of two components: a two-digit number and a letter. These two components respectively represent the first group and second group of offenses. For instance, 13 represents assaults, and the A, B, C that come after 13 specify the type and degree of assaults so that 13A represents aggravated assaults while 13B represents simple assaults. This classification approach has important legal and policy meanings. We can also utilize this classification approach to reduce our workloads.    </span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(offense) </span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense =</span> <span class="fu">factor</span>(offense)) <span class="sc">%&gt;%</span></span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense =</span> <span class="fu">fct_collapse</span>(offense,</span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Murder and Nonnegligent Manslaughter</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"09A"</span>,</span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Aggravated Assault</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"13A"</span>,</span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Assault or Intimidation</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"13B"</span>, <span class="st">"13C"</span>),</span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sexual Assault or Rape</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"11A"</span>, <span class="st">"11C"</span>, <span class="st">"11D"</span>),</span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Robbery</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"120"</span>),</span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Arson and Kidnapping/Abduction</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"100"</span>, <span class="st">"200"</span>),</span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Burglary or Trespassing</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"220"</span>, <span class="st">"90J"</span>),</span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Theft, Auto-theft, and Larceny</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"23A"</span>, <span class="st">"23B"</span>, <span class="st">"23C"</span>, <span class="st">"23D"</span>, <span class="st">"23F"</span>, </span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"23G"</span>,<span class="st">"23H"</span>, <span class="st">"240"</span>),</span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Fraud</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"26A"</span>, <span class="st">"26C"</span>, <span class="st">"26D"</span>, <span class="st">"26E"</span>, <span class="st">"26F"</span>, <span class="st">"26G"</span>),</span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Drug-related</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"35A"</span> , <span class="st">"35B"</span>),</span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Property Destruction</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"250"</span>, <span class="st">"280"</span>, <span class="st">"290"</span>),</span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a>   <span class="st">`</span><span class="at">Crime against sociey</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"370"</span>,<span class="st">"39A"</span>, <span class="st">"520"</span>, <span class="st">"90Z"</span>)</span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a>The 12 offense types above can be broadly characterized into four groups: violent crimes (or crimes against person), property crimes (crimes against property), and others (drug crimes and crimes against society) according to the object of crimes. The classification method follows how crimes are defined in criminal law and are commonly used by law enforcement agencies. For releveling purposes, we made this new variable a factor.</span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a>Violent_crimes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Murder and Nonnegligent Manslaughter"</span>,</span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Aggravated Assault"</span>,</span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Assault or Intimidation"</span>,</span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sexual Assault or Rape"</span>,</span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Robbery"</span>,</span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Arson and Kidnapping/Abduction"</span>)</span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a>Property_crimes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Burglary or Trespassing"</span>, </span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Theft, Auto-theft, and Larceny"</span>, </span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Fraud"</span>, </span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Property Destruction"</span>)</span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a>Drug_crimes <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Drug-related"</span>)</span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a>Crime_sociey <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Crime against sociey"</span>)</span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Violent_crimes <span class="sc">~</span> <span class="st">"Violent Crimes"</span>,</span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Property_crimes <span class="sc">~</span> <span class="st">"Property Crimes"</span>,</span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Drug_crimes <span class="sc">~</span> <span class="st">"Drug Crimes"</span>,</span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a>    offense <span class="sc">%in%</span> Crime_sociey <span class="sc">~</span> <span class="st">"Crime Against Society"</span></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">offense_group =</span> <span class="fu">fct_relevel</span>(offense_group,</span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="st">"Violent Crimes"</span>,</span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Property Crimes"</span>,</span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Drug Crimes"</span>,</span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Crime Against Society"</span>)</span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a>                                     ))</span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a>The remaining variables are a little bit tricky here. For <span class="in">`date`</span>, it makes little sense to know on which date arrests occurred but instead, knowing the months could provide some insights. Since <span class="in">`date`</span> is in its own type (by default, R makes all date/time-related variables in POSIXIt format), we use functions from the <span class="in">`lubridate`</span> package to make the transformation.</span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>), </span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> date) <span class="co"># add label = T makes month a ordered factor</span></span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a>For <span class="in">`arrest_type`</span>, this variable represents which stage of arrest the arrestee is on. Some people were arrested, some were waiting for the summoning of the court, and some were detained (in technical terms, these are stages in the "criminal justice funnel"). Because it represents three stages, we need to make it a categorical variable.</span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrest_type =</span> <span class="fu">factor</span>(arrest_type)) <span class="sc">%&gt;%</span></span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrest_type =</span> <span class="fu">fct_recode</span>(arrest_type, </span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">On View</span><span class="st">`</span>  <span class="ot">=</span> <span class="st">"1"</span>, </span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">Summoned/Cited</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a>                                <span class="st">`</span><span class="at">Custodied</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"3"</span>))</span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a><span class="co">#On View: arresting based on observations in lieu of written probable cause</span></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a>Lastly, for <span class="in">`age`</span>, we can either leave it be (good for histogram or area chart)or use it to make a new variable age_group (good for bar charts, line charts etc.), depending on the preference of the data scientist and/or the purpose of analysis. Here, I am adopting the latter approach.</span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a>dc21 <span class="ot">&lt;-</span> dc21 <span class="sc">%&gt;%</span></span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Under 20"</span>,</span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&gt;=</span><span class="dv">20</span> <span class="sc">~</span> <span class="st">"20-29"</span>,</span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span><span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span><span class="dv">40</span> <span class="sc">~</span> <span class="st">"30-39"</span>,</span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"40-49"</span>,</span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a>    age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"50 or above"</span></span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>,</span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"40-49"</span>, <span class="st">"50 or above"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(age_group, <span class="at">.after =</span> age)</span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final Check: Does any missing data arise after manipulations?</span></span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a>Now we are done with our data wrangling, but before we move to data exploration, let's make sure we are not leaving out any values. We can do so by checking there is no missing data.  </span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(dc21)) </span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a>Looks like we made no mistakes in previous steps. Good job! Here is what our final data looks like. Sounds good to you?</span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a>dc21 <span class="sc">%&gt;%</span> </span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-332"><a href="#cb28-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format=</span><span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-333"><a href="#cb28-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, </span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"hover"</span>, </span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"condensed"</span>))</span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a>Full code can be found on my <span class="co">[</span><span class="ot">Github repo</span><span class="co">](https://github.com/jcvincentliu/data-blogging/blob/main/UCR%202021%20DC%20Arrest%20Data%20Analysis.qmd)</span>.</span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a>In the next section, we will focus on using the tool of explorative data analysis(EDA) to inspect our data and answer the questions I posed at the beginning of this post. We will also talk about data storytelling - the art of using data to narrate a story. Stay tuned!</span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(dc21, <span class="at">file =</span> <span class="st">"data/final_data.rda"</span>)</span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(dc21, <span class="at">file =</span> <span class="st">"data/final_data.csv"</span>)</span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"graph/arrest_line_chart.png"</span>, <span class="at">plot =</span> p1,</span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"graph/offense_bar_chart.png"</span>, <span class="at">plot =</span> p2,</span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="UCR 2021 DC Arrest Data Analysis I_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>